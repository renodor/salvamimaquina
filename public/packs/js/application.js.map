{"version":3,"file":"js/application.js","mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;;;;;;;;;AChEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;ACJA;AACA;AAEA;AACA;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;;;;;;;;;;;;;;;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACtBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACtBA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACjBA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACvBA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC9BA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACnLA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACrGA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;;;;;;;;;;;;;;;;ACTA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACpEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;;;;;;;;;;;;;;;;AC1BA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC3CA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAYA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;AC5NA;AACA;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;;AAEA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAIA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;;AAEA;AAGA;AACA;;;;;;;;;;;;;;;;;AC/FA;AACA;AACA;;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://salvamimaquina/./app/javascript/channels/ sync _channel\\.js$","webpack://salvamimaquina/./app/javascript/application.js","webpack://salvamimaquina/./app/javascript/channels/index.js","webpack://salvamimaquina/./app/javascript/components/add_to_cart.js","webpack://salvamimaquina/./app/javascript/components/cart.js","webpack://salvamimaquina/./app/javascript/components/checkout_form.js","webpack://salvamimaquina/./app/javascript/components/flash.js","webpack://salvamimaquina/./app/javascript/components/navbar.js","webpack://salvamimaquina/./app/javascript/components/preview_image_on_file_select.js","webpack://salvamimaquina/./app/javascript/components/price_range_slider.js","webpack://salvamimaquina/./app/javascript/components/product_show_thumbnails.js","webpack://salvamimaquina/./app/javascript/components/product_show_variants.js","webpack://salvamimaquina/./app/javascript/components/products_filters_form.js","webpack://salvamimaquina/./app/javascript/components/products_search.js","webpack://salvamimaquina/./app/javascript/components/products_sidebar.js","webpack://salvamimaquina/./app/javascript/components/products_sorting.js","webpack://salvamimaquina/./app/javascript/components/quantity_selector.js","webpack://salvamimaquina/./app/javascript/components/trade_in_form.js","webpack://salvamimaquina/./app/javascript/plugins/init_mapbox.js","webpack://salvamimaquina/./app/javascript/plugins/swiper_slider.js"],"sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = \"./app/javascript/channels sync recursive _channel\\\\.js$\";\nmodule.exports = webpackEmptyContext;","// This file is automatically compiled by Webpack, along with any other files\n// present in this directory. You're encouraged to place your actual application logic in\n// a relevant structure within app/javascript and only use these pack files to reference\n// that code so it'll be compiled.\n\n// require(\"@rails/ujs\").start()\nrequire('turbolinks').start();\nrequire('@rails/activestorage').start();\nrequire('channels');\n\n\n// Uncomment to copy all static images under ../images to the output folder and reference\n// them with the image_pack_tag helper in views (e.g <%= image_pack_tag 'rails.png' %>)\n// or the `imagePath` JavaScript helper below.\n//\n// const images = require.context('../images', true)\n// const imagePath = (name) => images(name, true)\n\n// Packages\nimport 'bootstrap';\n\n// Internal Components\nimport { navbar } from './components/navbar';\nimport { addDinamysmToFlash } from './components/flash';\nimport { checkoutForm } from './components/checkout_form';\n// import { addressForm } from './components/address_form';\nimport { priceRangeSlider } from './components/price_range_slider';\nimport { productShowVariants } from './components/product_show_variants';\nimport { productShowThumbnails } from './components/product_show_thumbnails';\nimport { productsSidebar } from './components/products_sidebar';\nimport { productsFiltersForm } from './components/products_filters_form';\nimport { productsSorting } from './components/products_sorting';\nimport { productsSearch } from './components/products_search';\nimport { quantitySelector } from './components/quantity_selector';\nimport { addToCart } from './components/add_to_cart';\nimport { cart } from './components/cart';\nimport { previewImageOnFileSelect } from './components/preview_image_on_file_select';\nimport { tradeInForm } from './components/trade_in_form';\n\n// Internal Plugins\nimport { swiperSlider } from './plugins/swiper_slider';\nimport { initMapbox } from './plugins/init_mapbox';\n\n// Call your functions here\ndocument.addEventListener('turbolinks:load', () => {\n  navbar();\n  addDinamysmToFlash();\n  checkoutForm();\n  // addressForm();\n  priceRangeSlider();\n  productShowVariants();\n  productShowThumbnails();\n  productsSidebar();\n  productsFiltersForm();\n  productsSorting();\n  productsSearch();\n  quantitySelector();\n  addToCart();\n  cart();\n  previewImageOnFileSelect();\n  tradeInForm();\n\n  initMapbox();\n  swiperSlider();\n});\n","// Load all the channels within this directory and all subdirectories.\n// Channel files must be named *_channel.js.\n\nconst channels = require.context('.', true, /_channel\\.js$/);\nchannels.keys().forEach(channels);\n","// Update front end when a variant has been added to cart (via Ajax)\nimport { addFlashToDom } from './flash';\n\nconst addToCart = () => {\n  const cartForm = document.querySelector('#cart-form form');\n\n  if (cartForm) {\n    window.Modal = require('bootstrap/js/dist/modal');\n\n    // Listen on cart form ajax:success event (when a variant has successfully been added to cart), and:\n    // - update the navbar cart counter\n    // - display the add to cart modal with the variant name\n    cartForm.addEventListener('ajax:success', (event) => {\n      const payload = event.detail[0];\n\n      const cartQuantityTag = document.querySelector('#navbar-icons .navbar-cart-quantity');\n\n      if (cartQuantityTag) {\n        const newCartQuantity = parseInt(cartQuantityTag.innerHTML) + payload.quantity;\n        cartQuantityTag.innerHTML = newCartQuantity;\n        cartQuantityTag.classList.remove('display-none');\n      }\n\n      const addToCartModal = document.getElementById('addToCartModal');\n      addToCartModal.querySelector('.modal-body #variant-name').innerHTML = payload.variantName;\n      new Modal(addToCartModal).show();\n    });\n\n    // Listen on cart form ajax:error event (when there is an error trying to add a product to cart), and:\n    // - display a flash error message\n    cartForm.addEventListener('ajax:error', (event) => (addFlashToDom(event.detail[0].flash)));\n  }\n};\n\nexport { addToCart };\n","const cart = () => {\n  const cart = document.getElementById('cart-detail');\n  if (cart) {\n  //   const lineItems = cart.querySelectorAll('.line-item');\n  //   lineItems.forEach((lineItem) => {\n  //     const lineItemId = lineItem.dataset.id;\n  //     const cartItemDelete = lineItem.querySelector('.cart-item-delete');\n  //     cartItemDelete.addEventListener('click', (event) => {\n  //       fetch(`api/orders/${gon.order_info.number}/line_items/${lineItemId}`, {\n  //         method: 'DELETE',\n  //         headers: {\n  //           'X-Spree-Order-Token': gon.order_info.guest_token,\n  //           'accept': 'application/json'\n  //         }\n  //       })\n  //         .then((response) => response.json())\n  //         .then(({ lineItem }) => {\n  //           removeLineItem(lineItem.id);\n  //           updateOrderInfo()\n  //         });\n  //     })\n  //   })\n\n    //   const removeLineItem = (id) => {\n    //     cart.querySelector(`.line-item[data-id=\"${id}\"]`).remove()\n    //   }\n\n  //   const updateOrderInfo = () => {\n  //     fetch(`api/orders/${gon.order_info.number}`, {\n  //       headers: {\n  //         'X-Spree-Order-Token': gon.order_info.guest_token,\n  //         'accept': 'application/json'\n  //       }\n  //     })\n  //       .then((response) => response.json())\n  //       .then((data) => {\n  //         debugger\n  //       });\n  //   }\n  }\n};\n\nexport { cart };\n","const checkoutForm = () => {\n  const checkout = document.getElementById('checkout');\n  if (checkout) {\n    const inputs = checkout.querySelectorAll('input, select, textarea');\n    inputs.forEach((input) => {\n      input.addEventListener('invalid', (event) => {\n        input.classList.add('error');\n      });\n\n      input.addEventListener('blur', (event) => {\n        if (input.checkValidity()) {\n          input.classList.remove('error');\n        }\n      });\n    });\n  }\n};\n\nexport { checkoutForm };\n","// Add the given flash (html tag as a string) to the DOM, and then add dynamism to it\n// This method is a bit special, indeed instead of being imported in application.js,\n// it is imported in other modules when we need to add a flash after an ajax request (ex: add_to_cart.js)\nconst addFlashToDom = (flash) => {\n  const content = document.querySelector('body #wrapper #content');\n  content.insertAdjacentHTML('afterbegin', flash);\n  addDinamysmToFlash();\n};\n\n// Remove flash when clicking on cross and auto remove it after 10 seconds\n// (is imported in application.js, so it will be called automatically when page load,\n// and is also called by addFlashToDom() when needed)\nconst addDinamysmToFlash = () => {\n  const flash = document.querySelector('.flash');\n\n  if (flash) {\n    flash.querySelector('svg.close-flash').addEventListener('click', () => (flash.remove()));\n\n    setTimeout(() => {\n      flash.remove();\n    }, 10000);\n  }\n};\n\nexport { addFlashToDom, addDinamysmToFlash };\n","// method to open/close the navbar on mobile\nconst navbar = () => {\n  const navbarTogglers = document.querySelectorAll('.navbar-toggler');\n  const navbarCollapse = document.querySelector('.navbar-collapse');\n  const body = document.querySelector('body');\n\n  // listen clicks on the navbar toggle and open the navbar when clicked\n  navbarTogglers.forEach((navbarToggler) => {\n    navbarToggler.addEventListener('click', () => {\n      if (navbarCollapse.classList.contains('active')) {\n        navbarCollapse.classList.remove('active');\n        document.querySelector('.content-overlay').remove();\n        body.classList.remove('overflow-hidden', 'position-relative');\n      } else {\n        body.classList.add('overflow-hidden', 'position-relative');\n        const contentOverlay = document.createElement('div');\n        contentOverlay.classList.add('content-overlay');\n        body.appendChild(contentOverlay);\n        navbarCollapse.classList.add('active');\n      }\n    });\n  });\n};\n\nexport { navbar };\n","// When uploading an image to a form, display a preview of it next to the form input\nconst previewImageOnFileSelect = () => {\n  const formWithImages = document.querySelector('.form-with-images');\n\n  if (formWithImages) {\n    formWithImages.querySelectorAll('.image-input input').forEach((imageInput) => {\n      imageInput.addEventListener('change', () => {\n        const imagePreview = formWithImages.querySelector(`.image-preview[data-id='${imageInput.dataset.id}']`);\n        if (imageInput.files && imageInput.files[0]) {\n          const reader = new FileReader();\n          reader.onload = (event) => { imagePreview.src = event.currentTarget.result; };\n          reader.readAsDataURL(imageInput.files[0]);\n          imagePreview.classList.remove('display-none');\n        }\n      });\n    });\n  }\n};\n\nexport { previewImageOnFileSelect };\n","const priceRangeSlider = () => {\n  const priceRangeSliders = document.querySelectorAll('.price-range-slider');\n\n  if (priceRangeSliders.length > 0) {\n    priceRangeSliders.forEach((priceRangeSlider) => {\n      const ranges = priceRangeSlider.querySelectorAll('input[type=\"range\"]');\n      const currentValues = priceRangeSlider.querySelectorAll('.current-values span');\n\n      ranges.forEach((range) => {\n        range.oninput = () => {\n          let slide1 = parseFloat(ranges[0].value);\n          let slide2 = parseFloat(ranges[1].value);\n\n          if (slide1 > slide2) {\n            [slide1, slide2] = [slide2, slide1];\n          }\n\n          currentValues[0].innerHTML= `$${slide1}`;\n          currentValues[1].innerHTML= `$${slide2}`;\n        };\n      });\n    });\n  }\n};\n\nexport { priceRangeSlider };\n","// Update the main image and the selected thumbnail when a thumbnail is clicked\nconst productShowThumbnails = () => {\n  const thumbnailsContainer = document.querySelectorAll('#product-show #thumbnails');\n\n  if (thumbnailsContainer) {\n    const mainImage = document.querySelector('#product-show #main-image img');\n    const thumbnails = document.querySelectorAll('#thumbnails .thumbnail');\n\n    const replaceMainImageSrc = ({ imageUrl, key }) => {\n      mainImage.src = imageUrl;\n      mainImage.dataset.key = key;\n    };\n\n    const setSelectedThumbnail = () => {\n      thumbnails.forEach((thumbnail) => {\n        if (thumbnail.dataset.key === mainImage.dataset.key) {\n          thumbnail.classList.add('selected');\n        } else {\n          thumbnail.classList.remove('selected');\n        }\n      });\n    };\n\n    thumbnails.forEach((thumbnail) => {\n      thumbnail.addEventListener('click', (event) => {\n        replaceMainImageSrc(event.currentTarget.dataset);\n        setSelectedThumbnail();\n      });\n    });\n  }\n};\n\nexport { productShowThumbnails };\n","// Update variant information on product show (price, add to cart btn, image, thumbnail, available options etc...) regarding what variant is selected\nconst productShowVariants = () => {\n  const productShow = document.querySelector('#product-show');\n  const productVariants = productShow?.querySelector('#product-variants');\n\n  if (productVariants) {\n    const cartForm = productShow.querySelector('#cart-form > form');\n    const mainImage = productShow.querySelector('#main-image img');\n    const variantIdInput = cartForm.querySelector('#variant_id');\n\n    // Update the quantity selector with the total stock\n    // and enable/disable the add and remove quantity trigger regarding the stock level of the new variant\n    const updateQuantityInput = ({ totalStock }) => {\n      const quantityInput = cartForm.querySelector('.add-to-cart .quantity-selector input#quantity');\n      const addQuantityTrigger = cartForm.querySelector('.add-to-cart .quantity-selector span[data-type=\"add\"]');\n      const removeQuantityTrigger = cartForm.querySelector('.add-to-cart .quantity-selector span[data-type=\"remove\"]');\n\n      quantityInput.value = 1;\n      quantityInput.dataset.totalStock = totalStock;\n      removeQuantityTrigger.classList.add('disabled');\n      if (totalStock > 1) {\n        addQuantityTrigger.classList.remove('disabled');\n      } else {\n        addQuantityTrigger.classList.add('disabled');\n      }\n    };\n\n    // Enable/disable add to cart btn and update its text regarding if variant is available or not\n    const updateAddToCartBtn = ({ totalStock }) => {\n      const addToCartBtn = cartForm.querySelector('.add-to-cart #add-to-cart-btn');\n      const itemPropAvailability = cartForm.querySelector('link[itemprop=availability]');\n      if (totalStock > 0) {\n        addToCartBtn.disabled = false;\n        addToCartBtn.innerHTML = addToCartBtn.dataset.buy.toUpperCase();\n        itemPropAvailability.href = 'http://schema.org/InStock';\n      } else {\n        addToCartBtn.disabled = true;\n        addToCartBtn.innerHTML = addToCartBtn.dataset.outOfStock.toUpperCase();\n        itemPropAvailability.href = 'http://schema.org/OutOfStock';\n      }\n    };\n\n    // Update price (and discount price) regarding what variant is selected\n    const updateVariantPrice = ({ price, discountPrice, onSale }) => {\n      const priceTag = cartForm.querySelector('#product-price .price.original');\n      priceTag.innerHTML = price;\n      const discountPriceTag = cartForm.querySelector('#product-price .price.discount');\n      discountPriceTag.innerHTML = discountPrice;\n\n      const itemPropPrice = cartForm.querySelector('meta[itemprop=price]');\n\n      if (onSale) {\n        priceTag.classList.add('crossed');\n        discountPriceTag.classList.remove('display-none');\n        itemPropPrice.content = discountPrice.replace('$', '');\n      } else {\n        discountPriceTag.classList.add('display-none');\n        priceTag.classList.remove('crossed');\n        itemPropPrice.content = price.replace('$', '');\n      }\n    };\n\n    // Update image regarding what variant is selected\n    const updateVariantImage = ({ imageUrl, imageKey, imageAlt }) => {\n      mainImage.src = imageUrl;\n      mainImage.dataset.key = imageKey;\n      mainImage.alt = imageAlt;\n    };\n\n    // Update thumbnails regarding what variant is selected\n    const updateThumbnails = ({ id }) => {\n      const thumbnails = productShow.querySelectorAll('#thumbnails .thumbnail');\n      thumbnails.forEach((thumbnail) => {\n        if (parseInt(thumbnail.dataset.variantId) === id) {\n          thumbnail.style.display = 'block';\n          if (thumbnail.dataset.key == mainImage.dataset.key) {\n            thumbnail.classList.add('selected');\n          } else {\n            thumbnail.classList.remove('selected');\n          }\n        } else {\n          thumbnail.style.display = 'none';\n        }\n      });\n    };\n\n    // Update url params with the new variant id\n    // And the schema itemprop url meta tag with the new url\n    const updateCurrentUrl = (variantId) => {\n      const url = new URL(window.location);\n      url.searchParams.set('variant_id', variantId);\n      history.replaceState(history.state, '', url);\n      productShow.querySelector('[itemprop=url]').content = url;\n    };\n\n    // Update the schema itemprop condition meta tag with the new variant condition\n    const updateConditionMetaTag = (variantCondition) => {\n      const conditionMetaTag = productShow.querySelector('[itemprop=itemCondition]');\n      conditionMetaTag.href = variantCondition === 'original' ? 'http://schema.org/NewCondition' : 'http://schema.org/RefurbishedCondition';\n    };\n\n    // Fetch the selected variant thanks to the current selected option values\n    // Then call the different methods to update all the variant informations (price, image, thumbnails etc...)\n    const updateVariantInformations = () => {\n      const formData = new FormData(cartForm);\n      const queryString = new URLSearchParams(formData);\n      fetch(`/products/variant_with_options_hash?${queryString}`, { headers: { 'accept': 'application/json' } })\n          .then((response) => response.json())\n          .then((variant) => {\n            variantIdInput.value = variant.id;\n            updateVariantImage(variant);\n            updateThumbnails(variant);\n            updateQuantityInput(variant);\n            updateAddToCartBtn(variant);\n            updateVariantPrice(variant);\n            updateCurrentUrl(variant.id);\n            updateConditionMetaTag(variant.condition);\n          });\n    };\n\n    // Update variant information when page loads\n    updateVariantInformations();\n\n    const productId = cartForm.querySelector('#product_id').value;\n    Array.from(cartForm.elements).forEach((formElement) => {\n      // Add an event listener to all inputs of the \"cart form\" used to select variant options\n      formElement.addEventListener('change', (event) => {\n        // When an option value is selected call /products/product_variants_with_option_values\n        // This endpoints will find all variants of this product that have this option value\n        // And then returns a hash of those variants option values grouped by option type\n        const selectedOptionValue = event.currentTarget;\n\n        // Changing quantity is also part of the cartForm but we handle it in a separate quantity_selector.js file,\n        // because it is not related to variant changes, and not specific to product show.\n        if (selectedOptionValue.name == 'quantity') { return; };\n\n        const selectedOptionTypeId = selectedOptionValue.tagName === 'SELECT' ? selectedOptionValue.dataset.id : selectedOptionValue.dataset.optionTypeId;\n        const queryString = `product_id=${productId}&selected_option_type=${selectedOptionTypeId}&selected_option_value=${selectedOptionValue.value}`;\n        fetch(`/products/product_variants_with_option_values?${queryString}`, { headers: { 'accept': 'application/json' } })\n            .then((response) => response.json())\n            .then((optionValuesByOptionType) => {\n              // For each option types returned, find the corresponding option values on the page and then:\n              // - If this option type is the one that the user just selected, we enable all option values (Because we want the user to be able to change the option value of the selected option type)\n              // - If not, disable/enable option values that are not included in the returned results from the endpoint (Indeed it means that for the selected option type, there are no variant with those option values, so we need to prevent user from selecting it)\n              // - After doing this process, if one (previously) selected option value is now disabled, we need to change it. So we find the first not-disabled option value of the same option type and select it.\n              Object.entries(optionValuesByOptionType).forEach((optionType) => {\n                const optionValueTags = Array.from(cartForm.querySelectorAll(`[data-option-type-id='${optionType[0]}']`));\n\n                // The \"model\" option type is returned by the endpoint but is hidden on the page by default,\n                // so we won't find a corresponding option value tags. In that case we just skip it and pass to the next iteration\n                if (optionValueTags.length == 0) { return; };\n\n                if (selectedOptionTypeId === optionType[0]) {\n                  optionValueTags.forEach((optionValueTag) => optionValueTag.disabled = false);\n                } else {\n                  optionValueTags.forEach((optionValueTag) => {\n                    optionValueTag.disabled = !optionType[1].some((optionValue) => optionValue.id === parseInt(optionValueTag.value));\n                  });\n\n                  if (optionValueTags.find((optionValueTag) => optionValueTag.selected || optionValueTag.checked)?.disabled) {\n                    const firstNonDisabledOptionValue = optionValueTags.find((optionValueTag) => optionValueTag.disabled === false);\n                    switch (firstNonDisabledOptionValue.tagName) {\n                      case 'INPUT':\n                        firstNonDisabledOptionValue.checked = true;\n                        break;\n                      case 'OPTION':\n                        firstNonDisabledOptionValue.selected = true;\n                        break;\n                    }\n                  }\n                }\n              });\n              // When we all this process is done we can ends up with a new set of selected option values.\n              // We thus need to fetch the corresponding variant and update all variant informations.\n              updateVariantInformations();\n            });\n      });\n    });\n  }\n};\n\nexport { productShowVariants };\n","// Update product grid with the relevant products when a products filter (or sorting) is selected\nconst productsFiltersForm = () => {\n  const productsSearcherForm = document.querySelector('form#products-filters-form');\n\n  if (productsSearcherForm) {\n    // HTML of a product card\n    const productCardHtml = (product) => {\n      return `\n        <li id=\\\"product_${product.id}\\\" data-hook=\"products_list_item\" itemscope itemtype=\"http://schema.org/Product\">\n          <div class=\"product-image\">\n            <img src=\"${product.image_url}\">\n          </div>\n          <div class=\"product-name\">${product.name}</div>\n          <span class=\"prices\" itemprop=\"offers\" itemscope itemtype=\"http://schema.org/Offer\">\n            ${product.cheapest_variant_onsale ? discountPriceHtml(product.discount_price, product.discount_price_html_tag) : ''}\n            <span class=\"price selling ${product.cheapest_variant_onsale ? 'crossed' : ''} itemprop=\"price\" content=\"${product.price}\">\n              ${product.price_html_tag}\n            </span>\n          </span>\n          <a href=${product.url} class=\"product-link full-absolute\" itemprop=\"name\" title=${product.name}></a>\n        </li >\n      `;\n    };\n\n    // HTML of a discount price to display if a product is on sale\n    const discountPriceHtml = (discountPrice, discountPriceHtmlTag) => {\n      return `\n        <span class=\"price selling\" itemprop=\"price\" content=\"${discountPrice}\">\n          ${discountPriceHtmlTag}\n        </span >\n      `;\n    };\n\n    // To display if no products are found\n    const displayNoProductsMessage = (noProductMessage) => {\n      document.getElementById('products').innerHTML = `\n        <div>\n          ${noProductMessage}\n        </div>\n      `;\n    };\n\n    // Display all newly found products\n    const updateProducts = (products) => {\n      const productsGrid = document.getElementById('products');\n      productsGrid.innerHTML = '';\n      products.forEach((product) => {\n        productsGrid.insertAdjacentHTML('beforeend', productCardHtml(product));\n      });\n    };\n\n    // On mobile we display the number of selected filters (on the filters modal trigger, and erase filter button)\n    // This method update filters count each time a filter is added/removed\n    const updateFilterCount = (formDataEntries) => {\n      const priceRangeSlider = productsSearcherForm.querySelector('.price-range-slider .slider input');\n\n      if (!priceRangeSlider) { return; }\n\n      let count = 0;\n      const priceRangeSlideMinMax = [priceRangeSlider.min, priceRangeSlider.max];\n\n      // Loop over all filters to determine if we count it or not.\n      // Indeed, we don't count \"sorting\", and we count price range only if they have been used (if the values are different from the original min and max values)\n      for (const [key, value] of formDataEntries) {\n        if (key === 'search[price_between][]') {\n          if (!priceRangeSlideMinMax.includes(value)) {\n            count += 1;\n          }\n        } else if (key.startsWith('search')) {\n          count += 1;\n        }\n      }\n\n      const filterCounts = document.querySelectorAll('#products-sidebar .filter-count');\n      filterCounts.forEach((filterCount) => {\n        filterCount.innerHTML = count > 0 ? `(${count})` : '';\n      });\n    };\n\n    // Fetch products each time a filter change. (We don't wait for form submission)\n    [...productsSearcherForm.elements].forEach((input) => {\n      input.addEventListener('change', () => {\n        const formData = new FormData(productsSearcherForm);\n        const queryString = new URLSearchParams(formData);\n\n        // The searchKeywords is not part of the products filters form (its part of the products search form),\n        // but needs to be added here in case users refine search results with filters\n        const searchKeywordsQuery = new URLSearchParams(window.location.search).get('keywords');\n        if (searchKeywordsQuery) { queryString.set('keywords', searchKeywordsQuery); }\n\n        // Fetch new products from those form data\n        fetch(`/products/filter?${queryString.toString()}`, { headers: { 'accept': 'application/json' } })\n            .then((response) => response.json())\n            .then(({ products, noProductsMessage }) => {\n              products.length === 0 ? displayNoProductsMessage(noProductsMessage) : updateProducts(products);\n            });\n\n        updateFilterCount(formData.entries());\n      });\n    });\n  }\n};\n\nexport { productsFiltersForm };\n","// Focus on search input when products search model is open\nconst productsSearch = () => {\n  const productsSearchModal = document.querySelector('#productsSearchModal');\n\n  if (productsSearchModal) {\n    productsSearchModal.addEventListener('shown.bs.modal', () => {\n      productsSearchModal.querySelector('input#keywords').focus();\n    });\n  };\n};\n\nexport { productsSearch };\n","// On desktop the products filters are on a sidebar and the products sorting is a dropdown,\n// on mobile both are in a modal in 2 different tabs\n// So we need to adapt those different elements to mobile/desktop views\nconst productsSidebar = () => {\n  const productsSidebar = document.getElementById('products-sidebar');\n\n  if (productsSidebar) {\n    const body = document.querySelector('body');\n    const productsSidebarContent = productsSidebar.querySelector('#products-sidebar-content');\n    const showProductsSidebarContentBtn = productsSidebar.querySelector('#show-products-sidebar-content');\n    const hideProductsSidebarContentBtns = productsSidebar.querySelectorAll('.hide-products-sidebar-content');\n\n    // Add bootstrap tab classes to show the products filters tab by default\n    // (and hide the products sorting tab)\n    const displayFilterTab = () => {\n      const filterTabId = 'product-filters-tab';\n      const sortingTabId = 'products-sorting-tab';\n      const productsFilterTabBtn = productsSidebar.querySelector(`#${filterTabId}`);\n      const productsSortingTabBtn = productsSidebar.querySelector(`#${sortingTabId}`);\n      const productsFilterTabContent = productsSidebar.querySelector(`#${filterTabId}-content`);\n      const productsSortingTabContent = productsSidebar.querySelector(`#${sortingTabId}-content`);\n\n      productsFilterTabBtn.classList.add('active');\n      productsFilterTabBtn.ariaSelected = true;\n      productsSortingTabBtn.classList.remove('active');\n      productsSortingTabBtn.ariaSelected = false;\n\n      productsFilterTabContent.classList.add('active', 'show');\n      productsSortingTabContent.classList.remove('active', 'show');\n    };\n\n    // On desktop, show the products sidebar,\n    // on mobile show the products filters and sorting modal\n    const setProductsSidebar = () => {\n      if (window.innerWidth > 767) {\n        productsSidebarContent.classList.remove('mobile');\n        productsSidebarContent.classList.remove('show');\n      } else {\n        productsSidebarContent.classList.add('mobile');\n        body.classList.remove('overflow-hidden');\n        displayFilterTab();\n      }\n    };\n\n    window.addEventListener('resize', () => {\n      setProductsSidebar();\n    });\n\n    setProductsSidebar();\n\n    // Button that opens the products filters and sorting modal\n    showProductsSidebarContentBtn.addEventListener('click', () => {\n      body.classList.add('overflow-hidden', 'position-relative');\n      const contentOverlay = document.createElement('div');\n      contentOverlay.classList.add('content-overlay');\n      body.appendChild(contentOverlay);\n      productsSidebarContent.classList.add('show');\n    });\n\n    // Buttons that hide the products filters and sorting modal\n    hideProductsSidebarContentBtns.forEach((hideProductsSidebarContentBtn) => {\n      hideProductsSidebarContentBtn.addEventListener('click', () => {\n        productsSidebarContent.classList.remove('show');\n        document.querySelector('.content-overlay').remove();\n        body.classList.remove('overflow-hidden', 'position-relative');\n      });\n    });\n  }\n};\n\nexport { productsSidebar };\n","// Set products sorting displayed text regarding what sorting is currently applied\nconst productsSorting = () => {\n  // There are actually 2 products sortings. So this selector will get the first one,\n  // it is enough to know if we should execute this script or not\n  // (But we won't use it later in the script because we need to work with both forms)\n  const productsSorting = document.querySelector('.products-sorting');\n\n  if (productsSorting) {\n    const currentProductsSorting = document.getElementById('current-products-sorting');\n    const productsSortingOptions = document.querySelectorAll('.products-sorting-option input');\n\n    productsSortingOptions.forEach((productsSortingOption) => {\n      productsSortingOption.addEventListener('change', (event) => {\n        const selectedSortingKey = event.currentTarget.value;\n        productsSortingOptions.forEach((option) => option.classList.remove('selected'));\n        document.querySelectorAll(`input[value=${selectedSortingKey}]`).forEach((selectedSortingInput) => {\n          selectedSortingInput.checked = true;\n          // we need this .selected class because the default :checked css selector does not work properly,\n          // because those inputs are displayed 2 times on the same page, so we have 2 inputs with the same id...\n          selectedSortingInput.classList.add('selected');\n        });\n\n        currentProductsSorting.innerHTML = event.currentTarget.dataset.label;\n      });\n    });\n  };\n};\n\nexport { productsSorting };\n","const quantitySelector = () => {\n  const quantitySelector = document.querySelector('.quantity-selector');\n\n  if (quantitySelector) {\n    const quantityInput = quantitySelector.querySelector('input');\n    const addQuantityTrigger = quantitySelector.querySelector('span[data-type=\"add\"');\n    const removeQuantityTrigger = quantitySelector.querySelector('span[data-type=\"remove\"');\n\n    const changeQuantity = (newQuantity) => {\n      const totalStock = parseInt(quantityInput.dataset.totalStock);\n      if (totalStock === 1 || totalStock === 0) {\n        quantityInput.value = 1;\n      } else if (newQuantity <= 1) {\n        quantityInput.value = 1;\n        removeQuantityTrigger.classList.add('disabled');\n        addQuantityTrigger.classList.remove('disabled');\n      } else {\n        if (newQuantity >= totalStock) {\n          quantityInput.value = totalStock;\n          addQuantityTrigger.classList.add('disabled');\n          removeQuantityTrigger.classList.remove('disabled');\n        } else {\n          quantityInput.value = newQuantity;\n          addQuantityTrigger.classList.remove('disabled');\n        }\n        removeQuantityTrigger.classList.remove('disabled');\n      }\n    };\n\n    addQuantityTrigger.addEventListener('click', (_event) => {\n      changeQuantity(parseInt(quantityInput.value) + 1);\n    });\n\n    removeQuantityTrigger.addEventListener('click', (_event) => {\n      changeQuantity(parseInt(quantityInput.value) - 1);\n    });\n\n    quantityInput.addEventListener('change', (_event) => {\n      let selectedQuantity = parseInt(quantityInput.value);\n      selectedQuantity = isNaN(selectedQuantity) ? 1 : selectedQuantity;\n      changeQuantity(selectedQuantity);\n    });\n  }\n};\n\nexport { quantitySelector };\n","const tradeInForm = () => {\n  const tradeInForm = document.querySelector('#trade-in-form form');\n\n  if (tradeInForm) {\n    const tradeInCategories = tradeInForm.querySelector('#trade-in-categories');\n    const tradeInModels = tradeInForm.querySelector('#trade-in-models');\n    const tradeInModelPrice = tradeInForm.querySelector('.trade-in-model-price');\n    const tradeInSecondPart = tradeInForm.querySelector('.trade-in-second-part');\n    const taxons = tradeInForm.querySelector('#taxons');\n    const products = tradeInForm.querySelector('#products');\n    const variants = tradeInForm.querySelector('#variants');\n    const variantInfos = tradeInForm.querySelector('.variant-infos');\n    const invalidTradeIn = tradeInForm.querySelector('#invalid-trade-in');\n    const tradeInCta = tradeInForm.querySelector('#trade-in-cta');\n\n    const show = (...elements) => {\n      elements.forEach((element) => {\n        element.disabled = false;\n        element.classList.remove('hidden');\n      });\n    };\n\n    const hide = (...elements) => {\n      elements.forEach((element) => {\n        element.disabled = true;\n        element.classList.add('hidden');\n      });\n    };\n\n    // Update variant infos (price, image, name, max value, min value),\n    // (Method called when a new variant is selected, when a new product without variant is selected, or when a new trade in model is selected)\n    const changeVariantInfos = (variantId) => {\n      hide(variantInfos, tradeInCta);\n      const params = `trade_in_min_value=${tradeInModelPrice.dataset.minValue}&trade_in_max_value=${tradeInModelPrice.dataset.maxValue}`;\n      fetch(`/trade_in_requests/variant_infos/${variantId}/?${params}`, { headers: { 'accept': 'application/json' } })\n          .then((response) => response.json())\n          .then(({ tradeInIsValid, imageTag, name, options, minValue, maxValue, price }) => {\n            variantInfos.dataset.id = variantId;\n            if (tradeInIsValid) {\n              variantInfos.querySelector('.variant-image').innerHTML = imageTag;\n              variantInfos.querySelector('.variant-name').innerHTML = name;\n              variantInfos.querySelector('.variant-options').innerHTML = options;\n              variantInfos.querySelector('.variant-min-price').innerHTML = minValue;\n              variantInfos.querySelector('.variant-max-price').innerHTML = maxValue;\n              variantInfos.querySelector('.variant-price').innerHTML = price;\n              invalidTradeIn.classList.add('display-none');\n              show(variantInfos, tradeInCta);\n            } else {\n              invalidTradeIn.classList.remove('display-none');\n            }\n          });\n    };\n\n    // Update trade in model infos (name, min value, max value),\n    // (Method called when a new trade in model is selected)\n    const changeTradeInModelPrice = (selectedModel) => {\n      tradeInModelPrice.querySelector('.model-name').innerHTML = selectedModel.innerHTML;\n      tradeInModelPrice.querySelector('.model-min-value').innerHTML = selectedModel.dataset.minValueText;\n      tradeInModelPrice.querySelector('.model-max-value').innerHTML = selectedModel.dataset.maxValueText;\n      show(tradeInModelPrice);\n\n      tradeInModelPrice.dataset.minValue = selectedModel.dataset.minValue;\n      tradeInModelPrice.dataset.maxValue = selectedModel.dataset.maxValue;\n      tradeInModelPrice.querySelector('input#trade-in-model-min-value').value = selectedModel.dataset.minValue;\n      tradeInModelPrice.querySelector('input#trade-in-model-max-value').value = selectedModel.dataset.maxValue;\n      tradeInModelPrice.querySelector('input#trade-in-model-name').value = selectedModel.innerHTML;\n\n      show(tradeInSecondPart, taxons);\n    };\n\n    // Show/hide the correct select options of children depending on what parent is selected\n    // (Method called when a new parent is selected)\n    // We can't just display/hide the relevant options with CSS because safari browsers don't apply CSS on option tags...\n    const displayOptionsOfSelectedParent = (childrenSelectTag, parentId) => {\n      // Reset children select tag\n      childrenSelectTag.value = '';\n      childrenSelectTag.innerHTML = '';\n\n      // Add children select tag prompt\n      const prompt = document.createElement('option');\n      prompt.text = childrenSelectTag.dataset.prompt;\n      childrenSelectTag.add(prompt, 0);\n\n      // Retrieve all children select tag options (from an hidden div on the DOM)\n      const selectId = childrenSelectTag.id;\n      const optionsForSelect = [...tradeInForm.querySelectorAll(`.options-for-select[data-select-id=${selectId}] option`)];\n\n      // Add the relevant options to children select tag depending on what parent is selected\n      optionsForSelect.forEach((option) => {\n        if (option.dataset.parentId === parentId) {\n          childrenSelectTag.add(option.cloneNode(true));\n        }\n      });\n\n      // Display children select tag\n      show(childrenSelectTag);\n    };\n\n    // When selected trade in category change:\n    // - Hide trade in model price (in case it was already displayed)\n    // - Hide variant infos (in case it was already displayed)\n    // - Show the trade in models corresponding to the new selected trade in category (and hide the others)\n    tradeInCategories.addEventListener('change', (event) => {\n      hide(tradeInModelPrice, variantInfos, tradeInCta);\n      displayOptionsOfSelectedParent(tradeInModels, event.currentTarget.value);\n    });\n\n    // When selected trade in model change:\n    // - If the first option (the text placeholder), hide trade in model price and variant info (in case it was already displayed)\n    // - Update trade in model price with the infos of the new selected trade in model (name, min value, max value...)\n    // - Show the trade in model price\n    // - Update trade in model price data infos (minValue, maxValue)\n    // - Show the second part of the trade in form\n    // - If a variant is already selected, update its infos\n    tradeInModels.addEventListener('change', (event) => {\n      if (tradeInModels.selectedIndex === 0) {\n        hide(tradeInModelPrice, variantInfos, tradeInCta);\n      } else {\n        changeTradeInModelPrice(event.currentTarget.selectedOptions[0]);\n\n        if (variantInfos.dataset.id) {\n          changeVariantInfos(variantInfos.dataset.id);\n        }\n      }\n    });\n\n    // When selected taxon change:\n    // - Hide all variant options, variant infos and delete variant infos id (so that if trade in model change it won't trigger changes on variant infos)\n    // - Show the products corresponding to the new selected taxon (and hide the others)\n    taxons.addEventListener('change', (event) => {\n      [...variants.options].forEach((option, index) => {\n        if (index > 0) {\n          option.remove();\n        }\n      });\n\n      delete variantInfos.dataset.id;\n      hide(variantInfos, tradeInCta);\n\n      displayOptionsOfSelectedParent(products, event.currentTarget.value);\n    });\n\n    // When selected product change:\n    // - If this product has variants or if the option is the placeholder\n    //    - Show variants\n    //    - Hide variant infos (in case it was already displayed) and delete the variant info id\n    //    - Show the variants options corresponding to the new selected product (and hide the others)\n    // - Else if trade in model price is not set\n    //    - Hide variants\n    //    - Set the variant info id with the product master id (will be used to display the correct variant infos when a trade in model is selected)\n    // - Else this product don't have variants:\n    //    - hide variants\n    //    - change variant infos with the porduct master id\n    products.addEventListener('change', (event) => {\n      const productSelect = event.currentTarget;\n      const selectedOption = productSelect.selectedOptions[0];\n      if (selectedOption.dataset.hasVariants === 'true' || productSelect.selectedIndex === 0) {\n        show(variants);\n        hide(variantInfos, tradeInCta);\n        delete variantInfos.dataset.id;\n        displayOptionsOfSelectedParent(variants, productSelect.value);\n      } else if (tradeInModelPrice.classList.contains('hidden')) {\n        hide(variants);\n        variantInfos.dataset.id = selectedOption.dataset.masterId;\n      } else {\n        hide(variants);\n        changeVariantInfos(selectedOption.dataset.masterId);\n      }\n    });\n\n    // When selected variant change:\n    // - If the options is the placeholder, hide variant infos and delete the variant info id\n    // - Else if trade in model price is not set, set the variant info id with the variant id\n    // - Else change variant infos\n    variants.addEventListener('change', (event) => {\n      const variantSelect = event.currentTarget;\n      if (variantSelect.selectedIndex === 0) {\n        delete variantInfos.dataset.id;\n        hide(variantInfos, tradeInCta);\n      } else if (tradeInModelPrice.classList.contains('hidden')) {\n        variantInfos.dataset.id = variantSelect.value;\n      } else {\n        changeVariantInfos(variantSelect.value);\n      }\n    });\n\n    // If showFields is set to true, display all hidden fields by default\n    // This happens when user tries to submit a form with errors,\n    // the page is re-rendered and we need to display everything\n    if (tradeInForm.dataset.showFields === 'true') {\n      displayOptionsOfSelectedParent(tradeInModels, tradeInCategories.value);\n      displayOptionsOfSelectedParent(products, taxons.value);\n      changeTradeInModelPrice(tradeInModels.selectedOptions[0]);\n\n      const selectedProduct = products.selectedOptions[0];\n      if (selectedProduct.dataset.hasVariants === 'true') {\n        displayOptionsOfSelectedParent(variants, products.value);\n        changeVariantInfos(variants.value);\n        show(variants);\n      } else {\n        changeVariantInfos(selectedProduct.dataset.masterId);\n      }\n\n      show(\n          tradeInCategories,\n          tradeInModels,\n          tradeInModelPrice,\n          tradeInSecondPart,\n          taxons,\n          products,\n          variantInfos,\n          invalidTradeIn,\n          tradeInCta\n      );\n\n      window.Modal = require('bootstrap/js/dist/modal');\n      const myModal = new Modal(document.getElementById('tradeInFormModal'));\n      myModal.show();\n    }\n  }\n};\n\nexport { tradeInForm };\n","// Importing mapbox-gl with a bang (!mapbox-gl) exclude mapbox-gl from being transpiled by webpack\nimport mapboxgl from '!mapbox-gl';\n\nconst initMapbox = () => {\n  const mapElement = document.getElementById('map');\n\n  // Shown on the address page when defining shipping address\n  if (mapElement) {\n    // Get latitude and longitude hidden inputs\n    const latitudeInput = document.querySelector('[data-input=\"address_latitude\"]');\n    const longitudeInput = document.querySelector('[data-input=\"address_longitude\"]');\n\n    // Method that update the value of latitude and longitude hidden inputs\n    const updateCoordinates = () => {\n      latitudeInput.value = marker.getLngLat().lat;\n      longitudeInput.value = marker.getLngLat().lng;\n    };\n\n    // Update de displayed map by doing 3 things:\n    // - puting the marker on the center of the selected area\n    // - resizing the map\n    // - puting the center of the map on the selected area\n    const updateMap = (latitude, longitude) => {\n      marker.setLngLat([longitude, latitude]);\n      map.resize();\n      map.flyTo({ center: [longitude, latitude] });\n    };\n\n    // initialize a mapbox map in the center of Panama\n    mapboxgl.accessToken = gon.mapbox_api_key;\n    const map = new mapboxgl.Map({\n      container: 'map', // container ID\n      style: 'mapbox://styles/mapbox/streets-v11', // style URL\n      center: [-79.528142, 8.975448], // starting position [lng, lat]\n      zoom: 15 // starting zoom\n    });\n\n    // Create a new draggable market on the map, and put it by default in the center of Panama\n    const marker = new mapboxgl.Marker({\n      draggable: true\n    })\n        .setLngLat([-79.528142, 8.975448])\n        .addTo(map);\n\n    // Every time the marker is dragged, call updateCoordinates method\n    marker.on('dragend', updateCoordinates);\n\n    // When loading the page, call updateMap() if a point on the map has already been defined\n    // (It happens if user select a point on the map, validates, and then comes back to the page)\n    if (latitudeInput.value && longitudeInput.value) {\n      updateMap(latitudeInput.value, longitudeInput.value);\n    }\n\n    // Add en event listener on the area (corregimiento) input\n    // and update the map each time it changes\n    // + Nullify latitude and longitude hidden fields value, to be sure user will move the marker\n    const corregimientoInput = document.querySelector('[data-input=\"district_id\"]');\n    corregimientoInput.addEventListener('change', (event) => {\n      const indexOfSelectedDistrict = corregimientoInput.options.selectedIndex;\n      const latitude = parseFloat(corregimientoInput.options[indexOfSelectedDistrict].dataset.latitude);\n      const longitude = parseFloat(corregimientoInput.options[indexOfSelectedDistrict].dataset.longitude);\n      updateMap(latitude, longitude);\n      latitudeInput.value = longitudeInput.value = null;\n    });\n\n\n    // Prevent form submission if map marker have not been set\n    const submitAddressBtn = document.querySelector('input[type=submit][data-input=\"map_submit\"]');\n    submitAddressBtn.addEventListener('click', (event) => {\n      if (!latitudeInput.value || !longitudeInput.value) {\n        event.preventDefault();\n        document.getElementById('missing-map-pin').style.color = '#FD1015';\n        mapElement.style.border = '1px solid red';\n      }\n    });\n  }\n\n  const staticMapElement = document.getElementById('static-map');\n\n  // Shown on the confirmation page when displaying the shipping address\n  if (staticMapElement) {\n    const { latitude, longitude } = staticMapElement.dataset;\n    // initialize a mapbox map with shipping address coordinate\n    mapboxgl.accessToken = gon.mapbox_api_key;\n    const map = new mapboxgl.Map({\n      container: 'static-map', // container ID\n      style: 'mapbox://styles/mapbox/streets-v11', // style URL\n      center: [longitude, latitude], // starting position [lng, lat]\n      zoom: 15 // starting zoom\n    });\n\n    new mapboxgl.Marker()\n        .setLngLat([longitude, latitude])\n        .addTo(map);\n  }\n};\n\nexport { initMapbox };\n","// import Swiper JS: https://swiperjs.com/\nimport Swiper, { Autoplay, Navigation, Pagination, Manipulation } from 'swiper';\nSwiper.use([Autoplay, Navigation, Pagination, Manipulation]); // https://github.com/JayChase/angular2-useful-swiper/issues/48\n\nconst swiperSlider = () => {\n  const sliders = document.querySelectorAll('.swiper');\n\n  if (sliders.length > 0) {\n    // Add slides to slider\n    const addRelevantSlides = (slider, slides) => {\n      // Because swiper needs at least 1 slide to initiate loop we can't just remove all slides at the same time\n      // So we 1) add a placeholder > 2) remove all other slides > 3) add new slides > 4) remove placeholder\n      slider.prependSlide('<div class=\"swiper-slide placeholder-slide\">'); // 1)\n      slider.removeSlide([...Array(slider.slides.length).keys()].slice(1)); // 2)\n      slider.appendSlide(slides.map(({ link, images, alt }) => { // 3)\n        return `<div class=\"swiper-slide centered-flexbox\">\n          ${link ? `<a href=\"${decodeURIComponent(link)}\">` : ''}\n            <img src=\"${images[slider.currentBreakpoint]}\", alt=\"${decodeURIComponent(alt).replace(/\\+/g, ' ')}\" />\n          ${link ? `</a>` : ''}\n        </div>`;\n      }));\n      slider.removeSlide(0); // 4)\n    };\n\n    // Generate sliders with correct options for all DOM elements that have the .swiper class\n    sliders.forEach((slider) => {\n      // Get slider options from HTML view\n      const sliderOptions = JSON.parse(slider.dataset.sliderOptions);\n\n      // Initialize swiper instance with the slider options\n      const swiperSlider = new Swiper(`.swiper[data-slider-id=\"${slider.dataset.sliderId}\"]`, {\n        loop: true,\n        spaceBetween: sliderOptions.spaceBetweenSlides,\n\n        navigation: sliderOptions.navigation ? { nextEl: '.swiper-next', prevEl: '.swiper-prev' } : false,\n        pagination: sliderOptions.pagination ? { el: '.swiper-pagination', clickable: true } : false,\n\n        autoplay: {\n          enabled: sliderOptions.autoplay,\n          delay: sliderOptions.delayBetweenSlides,\n          disableOnInteraction: false\n        },\n\n        breakpoints: {\n          576: {\n            slidesPerView: sliderOptions.imagePerSlideS\n          },\n          768: {\n            slidesPerView: sliderOptions.imagePerSlideM\n          },\n          992: {\n            slidesPerView: sliderOptions.imagePerSlideL\n          },\n          1200: {\n            slidesPerView: sliderOptions.imagePerSlideXl\n          },\n          1400: { // We don't use this breakpoint for imagePerSlide config, but use it to display the slide image at the correct size\n            slidesPerView: sliderOptions.imagePerSlideXl\n          }\n        }\n      });\n      if (sliderOptions.disableLoop) { swiperSlider.disable(); }\n\n      // Get slide data from HTML view\n      const slides = JSON.parse(slider.dataset.slides);\n\n      addRelevantSlides(swiperSlider, slides);\n      // Whenever windows size hit a new breakpoint, update sliders with slides of the correct size\n      swiperSlider.on('breakpoint', () => (addRelevantSlides(swiperSlider, slides)));\n    });\n  }\n};\n\nexport { swiperSlider };\n\n"],"names":[],"sourceRoot":""}